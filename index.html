<script>
    function toggle(id) {
      const el = document.getElementById(id);
      el.style.display = (el.style.display === 'block') ? 'none' : 'block';
    }
    function showForm(id) {
      ['formulario', 'seguimiento', 'servicios', 'contacto'].forEach(function(section) {
        if (section !== id) document.getElementById(section).style.display = 'none';
      });
      const el = document.getElementById(id);
      el.style.display = 'block';
    }
    function toggleDarkMode() {
      const bg = document.body.style.backgroundColor;
      if (bg === 'white') {
        document.body.style.backgroundColor = '#121212';
        document.body.style.color = 'white';
      } else {
        document.body.style.backgroundColor = 'white';
        document.body.style.color = 'black';
      }
    }

    // CONEXIÓN REAL AL APPS SCRIPT
    document.getElementById("ordenForm").addEventListener("submit", function(e) {
      e.preventDefault();
      
      const datos = {
        nombre: document.getElementById("nombre").value,
        telefono: document.getElementById("telefono").value,
        email: document.getElementById("email").value,
        direccion: document.getElementById("direccion").value,
        tipo: document.getElementById("tipo").value,
        pin: document.getElementById("pin").value,
        detalle: document.getElementById("detalle").value
      };
      
      fetch("https://script.google.com/macros/s/AKfycbytNyGBjcp4wtLsdxznz8lH1N4McBuJjTThIzt4DqUSEANQz_1f881GTaK5hWByqQodHw/exec", {
        method: "POST",
        body: JSON.stringify(datos),
        headers: { "Content-Type": "application/json" }
      })
      .then(response => response.text())
      .then(responseText => {
        document.getElementById("respuesta").innerHTML = "✅ Orden enviada correctamente. Tu código es: " + responseText;
        document.getElementById("ordenForm").reset();
      })
      .catch(error => {
        console.error('Error:', error);
        document.getElementById("respuesta").innerHTML = "❌ Error al enviar la orden.";
      });
    });

    function consultarEstado() {
      const codigo = document.getElementById("codigo").value.trim();
      if (codigo) {
        document.getElementById("resultado").textContent = "Estado de orden " + codigo + ": En proceso.";
      } else {
        document.getElementById("resultado").textContent = "Por favor escribe un código.";
      }
    }
</script>